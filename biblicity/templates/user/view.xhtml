{% extends "../layout.xhtml" %}
{% block title %}{{user.name}} — {{c.config.Site.name}}{% end block %}
{% block main %}
<h1>{{user.name}}
	{% if user.email == c.session.get('email') %}
	<a class="fa fa-pencil editing_icon" href="{{c.config.Site.url}}/user/{{user.id}}/edit" title="Edit Profile"></a>
	{% elif user.email in [o.email for o in c.user.following] %}
	<a class="fa fa-user editing_icon" href="{{c.config.Site.url}}/user/{{user.id}}/unfollow" title="Unfollow {{user.name}}"><strong>–</strong></a>
	{% elif user.email not in [o.email for o in c.user.blocking] %}
	<a class="fa fa-user-plus editing_icon" href="{{c.config.Site.url}}/user/{{user.id}}/follow" title="Follow {{user.name}}"></a>
	<a class="fa fa-user-times editing_icon" href="{{c.config.Site.url}}/user/{{user.id}}/block" title="Block {{user.name}}"></a>
	{% else %}
	<a class="fa fa-user editing_icon" href="{{c.config.Site.url}}/user/{{user.id}}/unblock" title="Unblock {{user.name}}"></a>
	{% end if %}
</h1>
<p>{% raw user.bio %}</p>
{% if len(user.items()) > 0 %}
<div>
<h2>Recent Items</h2>
{% end if %}
{% set previous = [] %}
{% for item in user.items() %}
{% if item.id not in previous %}
<p>
	<strong><a href="{{c.config.Site.url}}/items/{{item.id_slash_title}}">{{item.title_with_bref or ''}}</a></strong> 
	(<em>{{str(item.created).split(' ')[0]}}</em>)
</p>
</div>
{% end if %}
{% set previous = previous + [item.previous_id] %}
{% end for %}

{% if len(user.following) > 0 %}
<div>
<h2><span class="fa fa-user-plus"></span> Following</h2>
{% for u in user.following %}
<p>
	<strong><a href="{{c.config.Site.url}}/user/{{u.id_slash_name}}">{{u.name}}</a></strong>
</p>
{% end for %}
</div>
{% end if %}

<div>&nbsp;</div>
{% end block %}